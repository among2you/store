<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Ninja Star Marketplace</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
</head>
<body>

<div id="login-container">
    <h2>Admin Login</h2>
    <input type="email" id="adminEmail" placeholder="Admin Email" required>
    <input type="password" id="adminPassword" placeholder="Password" required>
    <button onclick="login()">Login</button>
</div>

<div id="admin-panel" style="display:none;">
    <h1>Admin Panel - Ninja Star Marketplace</h1>
    <form id="productForm">
        <label for="bladeCount">Blade Count:</label>
        <input type="number" id="bladeCount" required>
        
        <label for="color">Color:</label>
        <input type="text" id="color" required>
        
        <label for="imageUrl">Image URL:</label>
        <input type="text" id="imageUrl" required>
        
        <button type="button" onclick="addProduct()">Add Ninja Star</button>
    </form>
    <button onclick="logout()">Logout</button>
</div>

<script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDUODWU7BjsFPqIYCETDvRmM4Mn0xwzyZ8",
        authDomain: "store-9fe4d.firebaseapp.com",
        projectId: "store-9fe4d",
        storageBucket: "store-9fe4d.firebasestorage.app",
        messagingSenderId: "838969552210",
        appId: "1:838969552210:web:bb7faa1ca1cc83b9705e8b",
        measurementId: "G-PEQDSMZQR2"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Admin Authentication
    function login() {
        const email = document.getElementById('adminEmail').value;
        const password = document.getElementById('adminPassword').value;

        auth.signInWithEmailAndPassword(email, password)
            .then(userCredential => {
                checkAdminPrivileges(userCredential.user);
            })
            .catch(error => {
                alert("Login failed: " + error.message);
            });
    }

    function checkAdminPrivileges(user) {
        db.collection('admins').doc(user.uid).get()
            .then(doc => {
                if (doc.exists) {
                    document.getElementById('login-container').style.display = 'none';
                    document.getElementById('admin-panel').style.display = 'block';
                } else {
                    alert("Access denied: You are not an admin.");
                    auth.signOut();
                }
            })
            .catch(error => {
                console.error("Error checking admin privileges:", error);
            });
    }

    // Add Product to Firestore
    function addProduct() {
        const bladeCount = document.getElementById('bladeCount').value;
        const color = document.getElementById('color').value;
        const imageUrl = document.getElementById('imageUrl').value;

        db.collection('products').add({
            bladeCount: bladeCount,
            color: color,
            image: imageUrl,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        })
        .then(() => {
            alert("Ninja Star added successfully!");
            document.getElementById("productForm").reset();
        })
        .catch(error => {
            console.error("Error adding product:", error);
        });
    }

    function logout() {
        auth.signOut().then(() => {
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('login-container').style.display = 'block';
        });
    }
</script>

</body>
</html>
